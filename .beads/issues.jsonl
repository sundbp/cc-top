{"id":"cc-top-0lq","title":"Fix j/k key binding conflict for event scrolling","description":"tui/keys.go binds both Up/Down and ScrollUp/ScrollDown to j/k keys. In handleDashboardKey(), Up/Down are checked before ScrollUp/ScrollDown, so pressing j/k always triggers session navigation, never event scrolling. Manual event scrolling via j/k is unreachable. Fix: use separate key bindings for event scrolling (e.g., Ctrl+J/Ctrl+K, or PgUp/PgDn, or dedicated scroll keys when event panel is focused).","status":"closed","priority":2,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:22:01.191225Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.985729Z","closed_at":"2026-02-15T04:43:25.985729Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-8he","title":"Fix loop detector duplicate event accumulation","description":"alerts/rules.go loopDetectorRule.Evaluate() re-processes ALL events from the store every evaluation cycle. Events already processed and added to r.failures get re-appended, causing duplicate timestamps. A single failure gets counted N times (N = number of eval cycles since event added). Loop detector fires prematurely/incorrectly. Fix: track last-processed event index or timestamp to skip already-seen events.","status":"closed","priority":1,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:44.242048Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.953322Z","closed_at":"2026-02-15T04:43:25.953322Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-a95","title":"Task Graph: /Users/nixlim/Sync/PROJECTS/foundry_zero/cc-top/.tasks/telemetry-enhancements.task.json","status":"open","priority":1,"issue_type":"epic","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T06:06:19.067527Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:19.067527Z","labels":["taskval-managed"]}
{"id":"cc-top-a95.1","title":"Extract cache tokens from api_request events","description":"The store captures cache_read_tokens and cache_creation_tokens from api_request event attributes and stores them as numeric fields in SessionData.\n\n## Inputs\n- **api_request_event** (`state.Event`): Name == claude_code.api_request -- Source: OTLP log records via receiver\n\n## Outputs\n- **cache_read_tokens** (`int64`): \u003e= 0 -- Dest: SessionData field\n- **cache_creation_tokens** (`int64`): \u003e= 0 -- Dest: SessionData field\n\n## Constraints\n- Must not break existing api_request event processing\n- Must handle missing or malformed cache token values gracefully\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-cache-tokens\",\"files_scope\":[\"internal/state/types.go\",\"internal/state/store.go\",\"internal/state/store_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"api_request_event\",\"type\":\"state.Event\",\"constraints\":\"Name == claude_code.api_request\",\"source\":\"OTLP log records via receiver\"}],\"outputs\":[{\"name\":\"cache_read_tokens\",\"type\":\"int64\",\"constraints\":\"\\u003e= 0\",\"destination\":\"SessionData field\"},{\"name\":\"cache_creation_tokens\",\"type\":\"int64\",\"constraints\":\"\\u003e= 0\",\"destination\":\"SessionData field\"}]}}","acceptance_criteria":"- SessionData has CacheReadTokens and CacheCreationTokens int64 fields\n- When an api_request event with cache_read_tokens=5000 is added, GetSession returns CacheReadTokens \u003e= 5000\n- When an api_request event with cache_creation_tokens=2000 is added, GetSession returns CacheCreationTokens \u003e= 2000\n- Events without cache token attributes leave the fields unchanged at 0\n- go test ./internal/state/... passes with 0 failures","status":"open","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:19.757419Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:34.420824Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.1","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:19.759126Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.10","title":"Aggregate tool execution performance metrics","description":"The stats calculator computes average and P95 duration_ms per tool_name from tool_result events and exposes the results in DashboardStats.\n\n## Inputs\n- **tool_result_events** (`list\u003cstate.Event\u003e`): Name == claude_code.tool_result, has tool_name and duration_ms attributes -- Source: State store events\n\n## Outputs\n- **tool_perf** (`list\u003cToolPerf\u003e`): One entry per tool_name with avg and p95 duration -- Dest: DashboardStats struct\n\n## Constraints\n- Must not degrade stats computation for large event counts\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"aggregate-tool-execution-perf\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"tool_result_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Name == claude_code.tool_result, has tool_name and duration_ms attributes\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"tool_perf\",\"type\":\"list\\u003cToolPerf\\u003e\",\"constraints\":\"One entry per tool_name with avg and p95 duration\",\"destination\":\"DashboardStats struct\"}]}}","acceptance_criteria":"- DashboardStats includes a ToolPerformance []ToolPerf field with ToolName, AvgDurationMS, P95DurationMS float64 fields\n- Given 20 tool_result events for Bash with durations [100..2000], AvgDurationMS is within 5% of the actual mean\n- P95DurationMS for a tool with 100 samples is \u003e= the 95th sample when sorted\n- Tools with no duration_ms attribute are excluded from performance stats\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:25.863418Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:39.556316Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.10","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:25.865023Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.11","title":"Track session.count metric for session detection","description":"The state store recognizes claude_code.session.count metrics and creates session entries upon receiving the first such metric, before any other data arrives.\n\n## Inputs\n- **session_count_metric** (`state.Metric`): Name == claude_code.session.count -- Source: OTLP metrics via receiver\n\n## Outputs\n- **session_entry** (`SessionData`): Created with StartedAt set to metric timestamp -- Dest: State store\n\n## Constraints\n- Must not affect existing session creation behavior for other metrics\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"track-session-count-metric\",\"files_scope\":[\"internal/state/store.go\",\"internal/state/store_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"session_count_metric\",\"type\":\"state.Metric\",\"constraints\":\"Name == claude_code.session.count\",\"source\":\"OTLP metrics via receiver\"}],\"outputs\":[{\"name\":\"session_entry\",\"type\":\"SessionData\",\"constraints\":\"Created with StartedAt set to metric timestamp\",\"destination\":\"State store\"}]}}","acceptance_criteria":"- When a session.count metric with session.id=abc123 arrives as the first data for that session, GetSession(abc123) returns a non-nil SessionData\n- The SessionData.StartedAt is set to the metric timestamp, not time.Now()\n- Subsequent metrics and events for the same session still function correctly\n- go test ./internal/state/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":15,"created_at":"2026-02-15T06:06:26.537341Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:40.109797Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.11","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:26.538851Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.12","title":"Extract speed (fast mode) attribute from events and metrics","description":"SessionData tracks whether a session is using fast mode based on the speed attribute present on events and metrics.\n\n## Inputs\n- **events_and_metrics** (`union(state.Event, state.Metric)`): May have speed attribute -- Source: State store\n\n## Outputs\n- **fast_mode** (`bool`): true when speed attribute present and non-empty -- Dest: SessionData.FastMode field\n\n## Constraints\n- Must be set from the most recent event/metric, not toggled permanently\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-speed-attribute\",\"files_scope\":[\"internal/state/types.go\",\"internal/state/store.go\",\"internal/state/store_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"events_and_metrics\",\"type\":\"union(state.Event, state.Metric)\",\"constraints\":\"May have speed attribute\",\"source\":\"State store\"}],\"outputs\":[{\"name\":\"fast_mode\",\"type\":\"bool\",\"constraints\":\"true when speed attribute present and non-empty\",\"destination\":\"SessionData.FastMode field\"}]}}","acceptance_criteria":"- SessionData has a FastMode bool field\n- When an event with speed=fast attribute arrives, GetSession returns FastMode == true\n- When no speed attribute is present on any event, FastMode remains false\n- go test ./internal/state/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":15,"created_at":"2026-02-15T06:06:27.211523Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:40.672307Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.12","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:27.21299Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.13","title":"Extract org and user identity attributes","description":"SessionData stores organization.id and user.account_uuid from OTLP resource or event attributes as identity metadata.\n\n## Inputs\n- **resource_or_event_attrs** (`map\u003cstring, string\u003e`): May contain organization.id and user.account_uuid keys -- Source: OTLP resource attributes or event attributes\n\n## Outputs\n- **org_id** (`string`): Empty if not present -- Dest: SessionData.OrgID field\n- **user_uuid** (`string`): Empty if not present -- Dest: SessionData.UserUUID field\n\n## Constraints\n- Must extract from resource attributes with same precedence as session.id\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-org-user-identity\",\"files_scope\":[\"internal/state/types.go\",\"internal/state/store.go\",\"internal/state/store_test.go\",\"internal/receiver/receiver.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"resource_or_event_attrs\",\"type\":\"map\\u003cstring, string\\u003e\",\"constraints\":\"May contain organization.id and user.account_uuid keys\",\"source\":\"OTLP resource attributes or event attributes\"}],\"outputs\":[{\"name\":\"org_id\",\"type\":\"string\",\"constraints\":\"Empty if not present\",\"destination\":\"SessionData.OrgID field\"},{\"name\":\"user_uuid\",\"type\":\"string\",\"constraints\":\"Empty if not present\",\"destination\":\"SessionData.UserUUID field\"}]}}","acceptance_criteria":"- SessionData has OrgID and UserUUID string fields\n- When OTLP payload has resource attribute organization.id=org_abc, GetSession returns OrgID == org_abc\n- When OTLP payload has resource attribute user.account_uuid=usr_xyz, GetSession returns UserUUID == usr_xyz\n- When attributes are absent, fields remain empty strings\n- go test ./internal/state/... passes with 0 failures\n- go test ./internal/receiver/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:27.876762Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:41.217221Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.13","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:27.878443Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.14","title":"Parse MCP server and tool names from tool_parameters JSON","description":"The event formatter and stats calculator extract mcp_server_name, mcp_tool_name, and skill_name from tool_parameters JSON when OTEL_LOG_TOOL_DETAILS is enabled.\n\n## Inputs\n- **tool_result_events** (`list\u003cstate.Event\u003e`): Has tool_parameters attribute containing JSON with mcp_server_name, mcp_tool_name, or skill_name -- Source: State store events\n\n## Outputs\n- **mcp_stats** (`map\u003cstring, int\u003e`): Keys are mcp_server_name:mcp_tool_name, values are counts -- Dest: DashboardStats struct\n- **formatted_events** (`list\u003cFormattedEvent\u003e`): Include MCP/skill info in display string -- Dest: Event stream\n\n## Constraints\n- Must not break existing bash_command extraction in alerts/rules.go loop detector\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"parse-mcp-tool-names\",\"files_scope\":[\"internal/events/formatter.go\",\"internal/events/formatter_test.go\",\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"tool_result_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Has tool_parameters attribute containing JSON with mcp_server_name, mcp_tool_name, or skill_name\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"mcp_stats\",\"type\":\"map\\u003cstring, int\\u003e\",\"constraints\":\"Keys are mcp_server_name:mcp_tool_name, values are counts\",\"destination\":\"DashboardStats struct\"},{\"name\":\"formatted_events\",\"type\":\"list\\u003cFormattedEvent\\u003e\",\"constraints\":\"Include MCP/skill info in display string\",\"destination\":\"Event stream\"}]}}","acceptance_criteria":"- When tool_parameters JSON contains mcp_server_name=github and mcp_tool_name=create_issue, the formatted event includes github:create_issue\n- DashboardStats includes an MCPToolUsage map[string]int field\n- When tool_parameters lacks MCP fields, behavior is unchanged from current\n- The existing bash_command extraction for loop detection still functions correctly\n- go test ./internal/events/... passes with 0 failures\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:28.527814Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:41.790107Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.14","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:28.529648Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.15","title":"Compute API latency percentiles P50 P95 P99","description":"The stats calculator computes P50, P95, and P99 latency percentiles from api_request duration_ms values and exposes them in DashboardStats alongside the existing average.\n\n## Inputs\n- **api_request_events** (`list\u003cstate.Event\u003e`): Name == claude_code.api_request, has duration_ms attribute -- Source: State store events\n\n## Outputs\n- **latency_percentiles** (`LatencyPercentiles struct`): Fields: P50, P95, P99 as float64 in seconds -- Dest: DashboardStats struct\n\n## Constraints\n- Must use sort-based percentile calculation, not approximate\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"compute-api-latency-percentiles\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"api_request_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Name == claude_code.api_request, has duration_ms attribute\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"latency_percentiles\",\"type\":\"LatencyPercentiles struct\",\"constraints\":\"Fields: P50, P95, P99 as float64 in seconds\",\"destination\":\"DashboardStats struct\"}]}}","acceptance_criteria":"- DashboardStats includes a LatencyPercentiles struct with P50, P95, P99 float64 fields in seconds\n- Given 100 api_request events with duration_ms linearly from 100 to 10000, P50 is within 10% of 5050ms converted to seconds\n- P95 \u003e= P50 and P99 \u003e= P95 for any non-trivial dataset\n- When no api_request events exist, all percentiles are 0\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:29.200733Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:42.363731Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.15","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:29.202035Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.16","title":"Add per-session cost threshold alerts","description":"The alert engine fires a per-session CostSurge alert when any individual session's cost exceeds a configurable threshold, in addition to the existing global CostSurge alert.\n\n## Inputs\n- **session_costs** (`list\u003cSessionData\u003e`): Each has TotalCost \u003e= 0 -- Source: State store sessions\n- **threshold** (`f64`): \u003e 0 -- Source: Config AlertsConfig\n\n## Outputs\n- **session_cost_alerts** (`list\u003cAlert\u003e`): Rule == CostSurge, SessionID non-empty -- Dest: Alert engine output\n\n## Constraints\n- Must reuse existing alert deduplication logic\n- Must not fire for sessions below the threshold\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"per-session-cost-alerts\",\"files_scope\":[\"internal/alerts/rules.go\",\"internal/alerts/engine.go\",\"internal/alerts/engine_test.go\",\"internal/config/config.go\",\"internal/config/defaults.go\",\"internal/config/config_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"session_costs\",\"type\":\"list\\u003cSessionData\\u003e\",\"constraints\":\"Each has TotalCost \\u003e= 0\",\"source\":\"State store sessions\"},{\"name\":\"threshold\",\"type\":\"f64\",\"constraints\":\"\\u003e 0\",\"source\":\"Config AlertsConfig\"}],\"outputs\":[{\"name\":\"session_cost_alerts\",\"type\":\"list\\u003cAlert\\u003e\",\"constraints\":\"Rule == CostSurge, SessionID non-empty\",\"destination\":\"Alert engine output\"}]}}","acceptance_criteria":"- AlertsConfig has a SessionCostThreshold float64 field configurable via TOML\n- When a session's TotalCost exceeds the threshold, an alert fires with the session's ID\n- The alert message includes the session ID and the cost amount\n- The global CostSurge alert continues to function unchanged\n- go test ./internal/alerts/... passes with 0 failures\n- go test ./internal/config/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T06:06:29.869954Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:42.932994Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.16","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:29.87143Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.17","title":"Implement cost forecasting with daily and monthly projection","description":"The burn rate calculator produces daily and monthly cost projections extrapolated from the current hourly rate trend, exposed in BurnRate for TUI display.\n\n## Inputs\n- **hourly_rate** (`f64`): \u003e= 0 -- Source: BurnRate.HourlyRate\n- **trend** (`TrendDirection`): TrendFlat, TrendUp, or TrendDown -- Source: BurnRate.Trend\n\n## Outputs\n- **daily_projection** (`f64`): \u003e= 0, in USD -- Dest: BurnRate.DailyProjection\n- **monthly_projection** (`f64`): \u003e= 0, in USD -- Dest: BurnRate.MonthlyProjection\n\n## Constraints\n- Projections use simple linear extrapolation (hourly * 24 / hourly * 720)\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"cost-forecasting\",\"files_scope\":[\"internal/burnrate/types.go\",\"internal/burnrate/calculator.go\",\"internal/burnrate/calculator_test.go\",\"internal/tui/burnrate.go\",\"internal/tui/burnrate_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"hourly_rate\",\"type\":\"f64\",\"constraints\":\"\\u003e= 0\",\"source\":\"BurnRate.HourlyRate\"},{\"name\":\"trend\",\"type\":\"TrendDirection\",\"constraints\":\"TrendFlat, TrendUp, or TrendDown\",\"source\":\"BurnRate.Trend\"}],\"outputs\":[{\"name\":\"daily_projection\",\"type\":\"f64\",\"constraints\":\"\\u003e= 0, in USD\",\"destination\":\"BurnRate.DailyProjection\"},{\"name\":\"monthly_projection\",\"type\":\"f64\",\"constraints\":\"\\u003e= 0, in USD\",\"destination\":\"BurnRate.MonthlyProjection\"}]}}","acceptance_criteria":"- BurnRate struct has DailyProjection and MonthlyProjection float64 fields\n- When HourlyRate is 1.00, DailyProjection == 24.00 and MonthlyProjection == 720.00\n- When HourlyRate is 0, projections are 0\n- The TUI burn rate panel displays the daily and monthly projections\n- go test ./internal/burnrate/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:30.52305Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:43.49899Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.17","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:30.524562Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.18","title":"Add /v1/metrics HTTP endpoint for metric ingestion","description":"The HTTP receiver handles POST /v1/metrics requests and stores received OTLP metrics in the state store, supporting both protobuf and JSON content types.\n\n## Inputs\n- **metrics_request** (`ExportMetricsServiceRequest`): Valid OTLP protobuf or JSON -- Source: HTTP POST /v1/metrics\n\n## Outputs\n- **stored_metrics** (`list\u003cstate.Metric\u003e`): Indexed by session ID -- Dest: State store\n\n## Constraints\n- Must follow same patterns as existing /v1/logs handler\n- Must support both protobuf and JSON content types\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"add-http-metrics-endpoint\",\"files_scope\":[\"internal/receiver/http.go\",\"internal/receiver/http_test.go\",\"internal/receiver/receiver.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"metrics_request\",\"type\":\"ExportMetricsServiceRequest\",\"constraints\":\"Valid OTLP protobuf or JSON\",\"source\":\"HTTP POST /v1/metrics\"}],\"outputs\":[{\"name\":\"stored_metrics\",\"type\":\"list\\u003cstate.Metric\\u003e\",\"constraints\":\"Indexed by session ID\",\"destination\":\"State store\"}]}}","acceptance_criteria":"- POST /v1/metrics with protobuf body returns 200 and metrics appear in state store\n- POST /v1/metrics with JSON body returns 200 and metrics appear in state store\n- GET /v1/metrics returns 405 Method Not Allowed\n- Malformed payloads return 400 with error message\n- Source port is extracted for PID correlation\n- go test ./internal/receiver/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T06:06:31.208201Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:44.074556Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.18","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:31.20985Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.19","title":"Preserve raw event attributes alongside formatted strings","description":"FormattedEvent stores the original raw attributes map in addition to the pre-formatted display string, enabling future drill-down features.\n\n## Inputs\n- **event** (`state.Event`): Has Attributes map -- Source: FormatEvent function input\n\n## Outputs\n- **raw_attributes** (`map\u003cstring, string\u003e`): Complete copy of event attributes -- Dest: FormattedEvent.RawAttributes field\n\n## Constraints\n- Must not increase memory usage by more than 2x per FormattedEvent\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"preserve-raw-event-attributes\",\"files_scope\":[\"internal/events/types.go\",\"internal/events/formatter.go\",\"internal/events/formatter_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"event\",\"type\":\"state.Event\",\"constraints\":\"Has Attributes map\",\"source\":\"FormatEvent function input\"}],\"outputs\":[{\"name\":\"raw_attributes\",\"type\":\"map\\u003cstring, string\\u003e\",\"constraints\":\"Complete copy of event attributes\",\"destination\":\"FormattedEvent.RawAttributes field\"}]}}","acceptance_criteria":"- FormattedEvent has a RawAttributes map[string]string field\n- After FormatEvent, RawAttributes contains all original event attributes\n- Modifying RawAttributes does not affect the original event (deep copy)\n- Existing Formatted string field is unchanged in format\n- go test ./internal/events/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:31.860865Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:44.646934Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.19","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:31.862206Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.2","title":"Add per-model cost breakdown to burn rate panel","description":"The burn rate display shows cost split by model name, with each model's hourly rate and total cost visible in the TUI.\n\n## Inputs\n- **cost_usage_metrics** (`list\u003cstate.Metric\u003e`): Name == claude_code.cost.usage, has model attribute -- Source: State store metrics\n- **sessions** (`list\u003cstate.SessionData\u003e`): Non-empty -- Source: State store\n\n## Outputs\n- **per_model_burn** (`list\u003cModelBurnRate\u003e`): One entry per distinct model -- Dest: BurnRate struct and TUI burn rate panel\n\n## Constraints\n- Must not degrade burn rate panel rendering performance\n- Must handle sessions with no model attribute gracefully\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"per-model-cost-in-burnrate\",\"files_scope\":[\"internal/burnrate/types.go\",\"internal/burnrate/calculator.go\",\"internal/burnrate/calculator_test.go\",\"internal/tui/burnrate.go\",\"internal/tui/burnrate_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"cost_usage_metrics\",\"type\":\"list\\u003cstate.Metric\\u003e\",\"constraints\":\"Name == claude_code.cost.usage, has model attribute\",\"source\":\"State store metrics\"},{\"name\":\"sessions\",\"type\":\"list\\u003cstate.SessionData\\u003e\",\"constraints\":\"Non-empty\",\"source\":\"State store\"}],\"outputs\":[{\"name\":\"per_model_burn\",\"type\":\"list\\u003cModelBurnRate\\u003e\",\"constraints\":\"One entry per distinct model\",\"destination\":\"BurnRate struct and TUI burn rate panel\"}]}}","acceptance_criteria":"- BurnRate struct includes a PerModel field containing per-model cost totals\n- When cost.usage metrics arrive with model=claude-sonnet-4-20250514 and model=claude-opus-4-20250514, both appear in burn rate output\n- The TUI burn rate panel renders per-model cost rows below the aggregate rate\n- go test ./internal/burnrate/... passes with 0 failures\n- go test ./internal/tui/... passes with 0 failures","status":"open","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T06:06:20.434015Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:34.973621Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.2","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:20.435375Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.20","title":"Make HighRejection alert threshold configurable","description":"The HighRejection alert rule reads its rejection rate threshold and time window from AlertsConfig instead of using hardcoded values of 50% and 5 minutes.\n\n## Inputs\n- **config** (`AlertsConfig`): Has HighRejectionPercent (1-100) and HighRejectionWindowMinutes (\u003e= 1) -- Source: Config TOML file\n\n## Outputs\n- **configurable_rule** (`highRejectionRule`): Uses config values instead of hardcoded 50% / 5min -- Dest: Alert engine rule set\n\n## Constraints\n- Must maintain backward compatibility with existing config files that lack these keys\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"configurable-high-rejection-threshold\",\"files_scope\":[\"internal/config/config.go\",\"internal/config/defaults.go\",\"internal/config/config_test.go\",\"internal/alerts/rules.go\",\"internal/alerts/engine.go\",\"internal/alerts/engine_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"config\",\"type\":\"AlertsConfig\",\"constraints\":\"Has HighRejectionPercent (1-100) and HighRejectionWindowMinutes (\\u003e= 1)\",\"source\":\"Config TOML file\"}],\"outputs\":[{\"name\":\"configurable_rule\",\"type\":\"highRejectionRule\",\"constraints\":\"Uses config values instead of hardcoded 50% / 5min\",\"destination\":\"Alert engine rule set\"}]}}","acceptance_criteria":"- AlertsConfig has HighRejectionPercent int and HighRejectionWindowMinutes int fields\n- Default values are HighRejectionPercent=50, HighRejectionWindowMinutes=5\n- Setting high_rejection_percent=30 in config.toml causes the alert to fire at 30% rejection rate\n- Setting high_rejection_window_minutes=10 in config.toml uses a 10-minute window\n- Config validation rejects HighRejectionPercent outside 1-100\n- go test ./internal/alerts/... passes with 0 failures\n- go test ./internal/config/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:32.545459Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:45.213253Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.20","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:32.546915Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.21","title":"Compute cache savings estimate from cache tokens and pricing","description":"The stats calculator computes estimated cache savings in USD using cache_read_tokens, configured pricing data, and the formula: cache_read_tokens * (input_price - cache_read_price) per million tokens.\n\n## Inputs\n- **cache_read_tokens** (`int64`): \u003e= 0 -- Source: SessionData.CacheReadTokens from extract-cache-tokens task\n- **pricing_config** (`map\u003cstring, [4]float64\u003e`): Model -\u003e [input, output, cache_read, cache_creation] per million -- Source: Config.Pricing\n\n## Outputs\n- **cache_savings_usd** (`f64`): \u003e= 0 -- Dest: DashboardStats.CacheSavingsUSD field\n\n## Constraints\n- Must use pricing data from config, not hardcoded prices\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"compute-cache-savings\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"cache_read_tokens\",\"type\":\"int64\",\"constraints\":\"\\u003e= 0\",\"source\":\"SessionData.CacheReadTokens from extract-cache-tokens task\"},{\"name\":\"pricing_config\",\"type\":\"map\\u003cstring, [4]float64\\u003e\",\"constraints\":\"Model -\\u003e [input, output, cache_read, cache_creation] per million\",\"source\":\"Config.Pricing\"}],\"outputs\":[{\"name\":\"cache_savings_usd\",\"type\":\"f64\",\"constraints\":\"\\u003e= 0\",\"destination\":\"DashboardStats.CacheSavingsUSD field\"}]}}","acceptance_criteria":"- DashboardStats includes a CacheSavingsUSD float64 field\n- Given 1M cache_read_tokens for claude-sonnet-4-20250514 with input_price=3.0 and cache_read_price=0.30, CacheSavingsUSD == 2.70\n- When pricing config is absent for a model, that model's cache tokens are excluded from savings\n- When CacheReadTokens is 0, CacheSavingsUSD is 0\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:33.216461Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:45.779049Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.21","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:33.221885Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-a95.21","depends_on_id":"cc-top-a95.1","type":"blocks","created_at":"2026-02-15T06:06:33.850728Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.3","title":"Extract and display full token type breakdown","description":"The stats calculator extracts output and cacheCreation token types from token.usage metrics and the TUI displays input/output/cacheRead/cacheCreation breakdown.\n\n## Inputs\n- **token_usage_metrics** (`list\u003cstate.Metric\u003e`): Name == claude_code.token.usage, type attribute in {input, output, cacheRead, cacheCreation} -- Source: State store metrics\n\n## Outputs\n- **token_breakdown** (`map\u003cstring, int64\u003e`): Keys: input, output, cacheRead, cacheCreation -- Dest: DashboardStats struct and TUI stats panel\n\n## Constraints\n- Must not change the existing cacheRead/input handling for CacheEfficiency\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-token-type-breakdown\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\",\"internal/tui/stats.go\",\"internal/tui/stats_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"token_usage_metrics\",\"type\":\"list\\u003cstate.Metric\\u003e\",\"constraints\":\"Name == claude_code.token.usage, type attribute in {input, output, cacheRead, cacheCreation}\",\"source\":\"State store metrics\"}],\"outputs\":[{\"name\":\"token_breakdown\",\"type\":\"map\\u003cstring, int64\\u003e\",\"constraints\":\"Keys: input, output, cacheRead, cacheCreation\",\"destination\":\"DashboardStats struct and TUI stats panel\"}]}}","acceptance_criteria":"- DashboardStats includes a TokenBreakdown map with keys input, output, cacheRead, cacheCreation\n- computeCacheEfficiency still returns correct values after the change\n- When token.usage metrics with type=output arrive, they appear in TokenBreakdown[output]\n- When token.usage metrics with type=cacheCreation arrive, they appear in TokenBreakdown[cacheCreation]\n- The TUI stats panel renders all four token type counts\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:21.078423Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:35.540089Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.3","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:21.080123Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.4","title":"Extract resource attributes from OTLP payloads","description":"The receiver extracts service.version, os.type, os.version, and host.arch from OTLP resource attributes and stores them as session metadata.\n\n## Inputs\n- **otlp_resource** (`resourcepb.Resource`): Contains standard resource attributes -- Source: OTLP metric and log payloads\n\n## Outputs\n- **session_metadata** (`SessionMetadata struct`): Fields: ServiceVersion, OSType, OSVersion, HostArch -- Dest: SessionData embedded struct\n\n## Constraints\n- Must not break existing session.id extraction from resource attributes\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-resource-attributes\",\"files_scope\":[\"internal/state/types.go\",\"internal/receiver/receiver.go\",\"internal/receiver/grpc.go\",\"internal/receiver/grpc_test.go\",\"internal/receiver/http.go\",\"internal/receiver/http_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"otlp_resource\",\"type\":\"resourcepb.Resource\",\"constraints\":\"Contains standard resource attributes\",\"source\":\"OTLP metric and log payloads\"}],\"outputs\":[{\"name\":\"session_metadata\",\"type\":\"SessionMetadata struct\",\"constraints\":\"Fields: ServiceVersion, OSType, OSVersion, HostArch\",\"destination\":\"SessionData embedded struct\"}]}}","acceptance_criteria":"- SessionData has a Metadata field with ServiceVersion, OSType, OSVersion, HostArch string fields\n- When an OTLP payload contains resource attribute service.version=1.0.32, GetSession returns Metadata.ServiceVersion == 1.0.32\n- When resource attributes are absent, the fields remain empty strings\n- Both gRPC and HTTP receivers extract resource attributes\n- go test ./internal/state/... passes with 0 failures\n- go test ./internal/receiver/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T06:06:21.734963Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:36.11116Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.4","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:21.736269Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.5","title":"Extract language attribute from code_edit_tool.decision metrics","description":"The stats calculator tracks per-session language breakdown from the language attribute on code_edit_tool.decision metrics and exposes it in DashboardStats.\n\n## Inputs\n- **decision_metrics** (`list\u003cstate.Metric\u003e`): Name == claude_code.code_edit_tool.decision, has language attribute -- Source: State store metrics\n\n## Outputs\n- **language_breakdown** (`map\u003cstring, int\u003e`): Key = language name, value = edit count -- Dest: DashboardStats struct\n\n## Constraints\n- Must not affect existing tool acceptance rate computation\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-language-attribute\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"decision_metrics\",\"type\":\"list\\u003cstate.Metric\\u003e\",\"constraints\":\"Name == claude_code.code_edit_tool.decision, has language attribute\",\"source\":\"State store metrics\"}],\"outputs\":[{\"name\":\"language_breakdown\",\"type\":\"map\\u003cstring, int\\u003e\",\"constraints\":\"Key = language name, value = edit count\",\"destination\":\"DashboardStats struct\"}]}}","acceptance_criteria":"- DashboardStats includes a LanguageBreakdown map[string]int field\n- When code_edit_tool.decision metrics with language=TypeScript arrive, LanguageBreakdown[TypeScript] \u003e 0\n- When language attribute is absent, no entry is added to the map\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:22.382214Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:36.679009Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.5","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:22.383693Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.6","title":"Use event.sequence for correct event ordering","description":"Events stored in SessionData are ordered by the event.sequence attribute when present, falling back to timestamp ordering when absent.\n\n## Inputs\n- **events** (`list\u003cstate.Event\u003e`): May have event.sequence attribute as monotonically increasing integer -- Source: State store events\n\n## Outputs\n- **ordered_events** (`list\u003cstate.Event\u003e`): Sorted by event.sequence (primary) then timestamp (secondary) -- Dest: SessionData.Events\n\n## Constraints\n- Must preserve backward compatibility when event.sequence is absent\n- Must not degrade AddEvent performance beyond O(n log n) for sort\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-event-sequence\",\"files_scope\":[\"internal/state/types.go\",\"internal/state/store.go\",\"internal/state/store_test.go\",\"internal/receiver/receiver.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"May have event.sequence attribute as monotonically increasing integer\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"ordered_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Sorted by event.sequence (primary) then timestamp (secondary)\",\"destination\":\"SessionData.Events\"}]}}","acceptance_criteria":"- state.Event has a Sequence int64 field extracted from the event.sequence attribute\n- When events arrive with event.sequence=3,1,2, ListSessions returns them ordered 1,2,3\n- When events lack event.sequence, they sort by Timestamp as before\n- Events with sequence sort before events without sequence at same timestamp\n- go test ./internal/state/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:23.040647Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:37.25943Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.6","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:23.041952Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.7","title":"Extract source attribute from tool_decision events","description":"The stats calculator aggregates tool decision sources (config, user_permanent, user_temporary, user_abort, user_reject) per session and exposes them in DashboardStats.\n\n## Inputs\n- **tool_decision_events** (`list\u003cstate.Event\u003e`): Name == claude_code.tool_decision, has source attribute -- Source: State store events\n\n## Outputs\n- **decision_sources** (`map\u003cstring, int\u003e`): Key = source value, value = count -- Dest: DashboardStats struct\n\n## Constraints\n- Must not affect existing tool decision formatting in events package\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"extract-tool-decision-source\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"tool_decision_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Name == claude_code.tool_decision, has source attribute\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"decision_sources\",\"type\":\"map\\u003cstring, int\\u003e\",\"constraints\":\"Key = source value, value = count\",\"destination\":\"DashboardStats struct\"}]}}","acceptance_criteria":"- DashboardStats includes a DecisionSources map[string]int field\n- When tool_decision events with source=config arrive, DecisionSources[config] \u003e 0\n- When tool_decision events with source=user_reject arrive, DecisionSources[user_reject] \u003e 0\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:23.748448Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:37.821756Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.7","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:23.750218Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.8","title":"Categorize API errors by status_code bucket","description":"The stats calculator buckets api_error events into rate-limit (429), auth-failure (401/403), server-error (5xx), and other categories, exposed in DashboardStats.\n\n## Inputs\n- **api_error_events** (`list\u003cstate.Event\u003e`): Name == claude_code.api_error, has status_code attribute -- Source: State store events\n\n## Outputs\n- **error_categories** (`map\u003cstring, int\u003e`): Keys: rate_limit, auth_failure, server_error, other -- Dest: DashboardStats struct\n\n## Constraints\n- Must handle missing or non-numeric status_code gracefully\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"categorize-api-errors\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"api_error_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Name == claude_code.api_error, has status_code attribute\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"error_categories\",\"type\":\"map\\u003cstring, int\\u003e\",\"constraints\":\"Keys: rate_limit, auth_failure, server_error, other\",\"destination\":\"DashboardStats struct\"}]}}","acceptance_criteria":"- DashboardStats includes an ErrorCategories map[string]int field\n- An api_error event with status_code=429 increments ErrorCategories[rate_limit]\n- An api_error event with status_code=401 increments ErrorCategories[auth_failure]\n- An api_error event with status_code=503 increments ErrorCategories[server_error]\n- An api_error event with status_code=400 increments ErrorCategories[other]\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:24.498391Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:38.408666Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.8","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:24.499668Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-a95.9","title":"Track API retry rate from attempt attribute","description":"The stats calculator computes an API retry rate metric from the attempt attribute on api_error events and exposes it in DashboardStats.\n\n## Inputs\n- **api_error_events** (`list\u003cstate.Event\u003e`): Name == claude_code.api_error, has attempt attribute as integer string -- Source: State store events\n\n## Outputs\n- **retry_rate** (`f64`): 0 \u003c= rate \u003c= 1 -- Dest: DashboardStats.RetryRate field\n\n## Constraints\n- Must handle missing or malformed attempt values gracefully\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"track-api-retry-attempts\",\"files_scope\":[\"internal/stats/types.go\",\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"api_error_events\",\"type\":\"list\\u003cstate.Event\\u003e\",\"constraints\":\"Name == claude_code.api_error, has attempt attribute as integer string\",\"source\":\"State store events\"}],\"outputs\":[{\"name\":\"retry_rate\",\"type\":\"f64\",\"constraints\":\"0 \\u003c= rate \\u003c= 1\",\"destination\":\"DashboardStats.RetryRate field\"}]}}","acceptance_criteria":"- DashboardStats includes a RetryRate float64 field\n- When 10 api_error events have attempt \u003e= 2 out of 20 total api_error events, RetryRate == 0.5\n- When no api_error events exist, RetryRate == 0\n- go test ./internal/stats/... passes with 0 failures","status":"open","priority":3,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T06:06:25.173551Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T06:06:38.97956Z","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-a95.9","depends_on_id":"cc-top-a95","type":"parent-child","created_at":"2026-02-15T06:06:25.177466Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-b6t","title":"Fix alert threshold defaults to match spec","description":"config/defaults.go has CostSurgeThresholdPerHour=100.00 (spec says 2.00, 50x too high) and RunawayTokenVelocity=200000 (spec says 50000, 4x too high). These defaults mean alerts practically never fire under normal usage. Fix: set defaults to spec values in defaults.go.","status":"closed","priority":2,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:51.988106Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.974889Z","closed_at":"2026-02-15T04:43:25.974889Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-cv7","title":"Fix cumulative counter mishandling in stats calculator","description":"stats/calculator.go computeLinesOfCode() and computeCounterMetric() sum raw metric m.Value across all data points. For cumulative counters, if a session reports commit count as 1, then 2, then 3, this sums to 6 instead of 3. Only the latest value (or delta) should be used. Affects: lines of code, commits, PRs stats.","status":"closed","priority":1,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:49.395844Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.971581Z","closed_at":"2026-02-15T04:43:25.971581Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-dzh","title":"Add global config file reading to process scanner","description":"Spec Step 4 of Process Discovery requires reading ~/.claude/settings.json env block and /Library/Application Support/ClaudeCode/managed-settings.json to determine telemetry status for all sessions regardless of per-process env vars. Currently the scanner only reads per-process env vars via KERN_PROCARGS2. A process configured via settings.json (not shell env) shows incorrect 'No telemetry' status until data actually flows. The hasReceivedData override partially masks this but initial classification is wrong.","status":"closed","priority":2,"issue_type":"feature","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:58.626192Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.982551Z","closed_at":"2026-02-15T04:43:25.982551Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-eho","title":"Task Graph: M1 - Foundation","status":"closed","priority":0,"issue_type":"epic","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T01:46:24.909577Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:32:26.986807Z","closed_at":"2026-02-15T02:32:26.986807Z","close_reason":"All 25 child tasks completed. Full build passes, all tests pass with -race.","labels":["taskval-managed"]}
{"id":"cc-top-eho.1","title":"Scaffold Go project structure with module, directories, and main entrypoint","description":"The cc-top Go module is initialized with package layout, main.go entrypoint, and go.mod with core dependencies (Bubble Tea, OTLP, TOML).\n\n## Inputs\n- **spec** (`string`): cc-top-v1-spec.md and cc-top-v1-plan-spec.md -- Source: Project documentation\n\n## Outputs\n- **go_module** (`Go module`): Valid go.mod with module path -- Dest: Project root\n- **directory_structure** (`directories`): Standard Go layout -- Dest: Project root\n\n## Constraints\n- Follow standard Go project layout conventions\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"scaffold-project\",\"files_scope\":[\"go.mod\",\"go.sum\",\"cmd/cc-top/main.go\",\"internal/**\"],\"effects\":\"\",\"inputs\":[{\"name\":\"spec\",\"type\":\"string\",\"constraints\":\"cc-top-v1-spec.md and cc-top-v1-plan-spec.md\",\"source\":\"Project documentation\"}],\"outputs\":[{\"name\":\"go_module\",\"type\":\"Go module\",\"constraints\":\"Valid go.mod with module path\",\"destination\":\"Project root\"},{\"name\":\"directory_structure\",\"type\":\"directories\",\"constraints\":\"Standard Go layout\",\"destination\":\"Project root\"}]}}","acceptance_criteria":"- go.mod exists with module github.com/nixlim/cc-top\n- go build ./... succeeds\n- Directories exist: cmd/cc-top/, internal/config/, internal/state/, internal/receiver/, internal/scanner/, internal/correlator/, internal/settings/, internal/burnrate/, internal/events/, internal/alerts/, internal/stats/, internal/tui/, internal/process/\n- cmd/cc-top/main.go contains a main() function that compiles","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:25.542211Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:14:08.197001Z","closed_at":"2026-02-15T02:14:08.197001Z","close_reason":"Scaffold complete: go.mod, all directories, type stubs, main.go, go build succeeds","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.1","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:25.54685Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.10","title":"Implement burn rate calculator with rolling averages and trend detection","description":"The burn rate calculator computes total session cost, rolling 5-minute $/hour rate, trend direction, token velocity, and maps rates to color thresholds.\n\n## Inputs\n- **cost_metrics** (`list\u003cCostMetric\u003e`): Cumulative cost.usage values with timestamps -- Source: State store\n- **token_metrics** (`list\u003cTokenMetric\u003e`): Cumulative token.usage counter values -- Source: State store\n- **thresholds** (`ColorThresholds`): Green below X, yellow below Y, red at Y+ -- Source: Config\n\n## Outputs\n- **burn_rate** (`BurnRate struct`): Total \u003e= 0, rate \u003e= 0 -- Dest: TUI burn rate panel\n\n## Constraints\n- Numerically accurate to within $0.01 for cost and 1 token/minute for velocity\n- Handle counter resets gracefully (negative delta = reset)\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-burn-rate-calculator\",\"files_scope\":[\"internal/burnrate/calculator.go\",\"internal/burnrate/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"cost_metrics\",\"type\":\"list\\u003cCostMetric\\u003e\",\"constraints\":\"Cumulative cost.usage values with timestamps\",\"source\":\"State store\"},{\"name\":\"token_metrics\",\"type\":\"list\\u003cTokenMetric\\u003e\",\"constraints\":\"Cumulative token.usage counter values\",\"source\":\"State store\"},{\"name\":\"thresholds\",\"type\":\"ColorThresholds\",\"constraints\":\"Green below X, yellow below Y, red at Y+\",\"source\":\"Config\"}],\"outputs\":[{\"name\":\"burn_rate\",\"type\":\"BurnRate struct\",\"constraints\":\"Total \\u003e= 0, rate \\u003e= 0\",\"destination\":\"TUI burn rate panel\"}]}}","acceptance_criteria":"- TotalCost() returns the sum of cost.usage across visible sessions\n- HourlyRate() with $0.25 in last 5 minutes returns $3.00/hr\n- HourlyRate() with $0.00 in last 5 minutes returns $0.00/hr\n- TrendDirection() returns Up when current 5-min window ($0.30) exceeds previous ($0.20)\n- TrendDirection() returns Down when current window is lower than previous\n- TrendDirection() returns Flat when windows are equal\n- ColorForRate($0.25/hr) returns Green with default thresholds\n- ColorForRate($1.00/hr) returns Yellow with default thresholds\n- ColorForRate($2.00/hr) returns Red with default thresholds\n- Custom thresholds from config override defaults\n- TokenVelocity() returns tokens per minute from counter deltas\n- Counter reset (prev $5.00, curr $0.50) treats previous as 0 and calculates from $0.50\n- TestBurnRate_TotalCost passes\n- TestBurnRate_RollingHourly passes\n- TestBurnRate_TrendDirection passes\n- TestBurnRate_ColourThresholds passes\n- TestBurnRate_CustomThresholds passes\n- TestBurnRate_TokenVelocity passes\n- TestBurnRate_CounterReset passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:30.928745Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:27:05.237727Z","closed_at":"2026-02-15T02:27:05.237727Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.10","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:30.929946Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.10","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:44.387956Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.10","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:44.787762Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.11","title":"Implement event formatter for all 5 OTLP event types","description":"The event formatter converts raw OTLP events into display-ready strings with type-specific formatting for user_prompt, tool_result, api_request, api_error, and tool_decision events.\n\n## Inputs\n- **event** (`OTLPEvent`): One of 5 known event types -- Source: State store\n\n## Outputs\n- **formatted** (`FormattedEvent`): Display string with session attribution, type icon, and details -- Dest: Event stream panel\n\n## Constraints\n- Token counts above 1000 display as 'Xk' (e.g., 2100 -\u003e 2.1k)\n- Durations display as seconds with 1 decimal place (e.g., 1200ms -\u003e 1.2s)\n- Cost displays with 2 decimal places prefixed by $ (e.g., $0.03)\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-event-formatter\",\"files_scope\":[\"internal/events/formatter.go\",\"internal/events/formatter_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"event\",\"type\":\"OTLPEvent\",\"constraints\":\"One of 5 known event types\",\"source\":\"State store\"}],\"outputs\":[{\"name\":\"formatted\",\"type\":\"FormattedEvent\",\"constraints\":\"Display string with session attribution, type icon, and details\",\"destination\":\"Event stream panel\"}]}}","acceptance_criteria":"- user_prompt event with prompt_length=342 for sess-abc formats as '[sess-abc] Prompt (342 chars)'\n- tool_result event with tool_name=Bash, success=true, duration_ms=1200 formats as '[session] Bash (1.2s)'\n- tool_result event with tool_name=Edit, success=false, decision=reject formats as '[session] Edit rejected by user'\n- api_request event with model=sonnet-4.5, input_tokens=2100, output_tokens=890, cost_usd=0.03, duration_ms=4200 formats as '[session] sonnet-4.5 -\u003e 2.1k in / 890 out ($0.03) 4.2s'\n- api_error event with status_code=529, error=overloaded, attempt=2 formats as '[session] 529 overloaded (attempt 2)'\n- tool_decision event with tool_name=Write, decision=accept, source=config formats as '[session] Write accepted (config)'\n- TestEventFormat_UserPrompt passes\n- TestEventFormat_ToolResultSuccess passes\n- TestEventFormat_ToolResultReject passes\n- TestEventFormat_APIRequest passes\n- TestEventFormat_APIError passes\n- TestEventFormat_ToolDecision passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:31.511654Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:19:34.131055Z","closed_at":"2026-02-15T02:19:34.131055Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.11","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:31.512915Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.11","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:45.180605Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.12","title":"Implement aggregate statistics calculator for the stats dashboard","description":"The stats calculator computes 9 aggregate metrics (lines of code, commits, PRs, tool acceptance rate, cache efficiency, average API latency, model breakdown, top tools, error rate) from state store data.\n\n## Inputs\n- **state** (`StateStore`): Contains all metrics and events -- Source: State store\n\n## Outputs\n- **stats** (`DashboardStats`): All 9 statistics computed -- Dest: TUI stats dashboard\n\n## Constraints\n- Pure computation from state store data  no side effects\n- Cache efficiency = cacheRead / (input + cacheRead), handle division by zero\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-stats-calculator\",\"files_scope\":[\"internal/stats/calculator.go\",\"internal/stats/calculator_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"state\",\"type\":\"StateStore\",\"constraints\":\"Contains all metrics and events\",\"source\":\"State store\"}],\"outputs\":[{\"name\":\"stats\",\"type\":\"DashboardStats\",\"constraints\":\"All 9 statistics computed\",\"destination\":\"TUI stats dashboard\"}]}}","acceptance_criteria":"- LinesOfCode() with type=added totalling 150 and type=removed totalling 30 returns {Added: 150, Removed: 30}\n- CommitsAndPRs() returns {Commits: 5, PRs: 2} when those counter metrics are present\n- ToolAcceptanceRate() with Edit accept=8, reject=2 returns {Edit: 80%}\n- CacheEfficiency() with cacheRead=80000 and input=20000 returns 80%\n- AvgAPILatency() with 10 api_request events averaging 3500ms returns 3.5s\n- ModelBreakdown() groups cost and tokens by model name\n- TopTools() ranks tools by frequency in descending order\n- ErrorRate() with 100 api_request and 5 api_error events returns 5.0%\n- TestStatsCalc_LinesOfCode passes\n- TestStatsCalc_CacheEfficiency passes\n- TestStatsCalc_ErrorRate passes\n- TestStatsCalc_ToolAcceptRate passes\n- TestStatsCalc_AvgLatency passes","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:32.107326Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:22:33.30463Z","closed_at":"2026-02-15T02:22:33.30463Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.12","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:32.108628Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.12","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:45.560218Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.13","title":"Implement --setup CLI flag for non-interactive telemetry configuration","description":"The cc-top --setup command runs settings merge in non-interactive mode, prints the result, and exits without starting the TUI.\n\n## Inputs\n- **setup_flag** (`bool`): Set via CLI --setup flag -- Source: CLI argument\n\n## Outputs\n- **stdout_message** (`string`): Success, already-configured, or error message -- Dest: stdout\n- **exit_code** (`int`): 0 on success, 1 on error -- Dest: Process exit code\n\n## Constraints\n- Non-interactive mode only  no TUI, no prompts\n- Must exit immediately after merge operation\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-cli-setup-command\",\"files_scope\":[\"cmd/cc-top/main.go\",\"cmd/cc-top/setup.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"setup_flag\",\"type\":\"bool\",\"constraints\":\"Set via CLI --setup flag\",\"source\":\"CLI argument\"}],\"outputs\":[{\"name\":\"stdout_message\",\"type\":\"string\",\"constraints\":\"Success, already-configured, or error message\",\"destination\":\"stdout\"},{\"name\":\"exit_code\",\"type\":\"int\",\"constraints\":\"0 on success, 1 on error\",\"destination\":\"Process exit code\"}]}}","acceptance_criteria":"- cc-top --setup with no existing settings.json creates the file and prints 'Settings written'\n- cc-top --setup with already-configured file prints 'Already configured' and exits 0\n- cc-top --setup with malformed settings.json prints the error and exits 1\n- cc-top --setup does not start the TUI or OTLP receivers\n- cc-top --setup with a differing endpoint value prints a warning and does not overwrite","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:32.706752Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:22:47.245464Z","closed_at":"2026-02-15T02:22:47.245464Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.13","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:32.708188Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.13","depends_on_id":"cc-top-eho.4","type":"blocks","created_at":"2026-02-15T01:46:45.945556Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.13","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:46.343353Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.14","title":"Implement telemetry status classifier for Claude Code processes","description":"The classifier reads a process's environment variables and categorizes its telemetry status as one of: Connected, Waiting, Wrong port, Console only, No telemetry, or Unknown.\n\n## Inputs\n- **process_info** (`ProcessInfo`): Must include env vars or EnvReadable=false flag -- Source: Process scanner\n\n## Outputs\n- **status** (`TelemetryStatus`): One of 6 enum values with icon and label -- Dest: Session list display\n\n## Constraints\n- Pure function: classify based on env vars and config only\n- Must compare against configured port, not hardcoded default\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-telemetry-classifier\",\"files_scope\":[\"internal/scanner/classifier.go\",\"internal/scanner/classifier_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"process_info\",\"type\":\"ProcessInfo\",\"constraints\":\"Must include env vars or EnvReadable=false flag\",\"source\":\"Process scanner\"}],\"outputs\":[{\"name\":\"status\",\"type\":\"TelemetryStatus\",\"constraints\":\"One of 6 enum values with icon and label\",\"destination\":\"Session list display\"}]}}","acceptance_criteria":"- Classify returns Connected with checkmark icon when CLAUDE_CODE_ENABLE_TELEMETRY=1 and OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317\n- Classify returns WrongPort with warning icon when CLAUDE_CODE_ENABLE_TELEMETRY=1 and endpoint points to port 9090\n- Classify returns ConsoleOnly with warning icon when CLAUDE_CODE_ENABLE_TELEMETRY=1 and no endpoint is set\n- Classify returns NoTelemetry with X icon when CLAUDE_CODE_ENABLE_TELEMETRY=0 or is absent\n- Classify returns Unknown with question-mark icon when EnvReadable=false\n- The configured gRPC port is used for the 'correct port' check (not hardcoded 4317)\n- TestTelemetryClassifier_Connected passes\n- TestTelemetryClassifier_WrongPort passes\n- TestTelemetryClassifier_ConsoleOnly passes\n- TestTelemetryClassifier_NoTelemetry passes\n- TestTelemetryClassifier_Unknown passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:33.298479Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:23:17.307777Z","closed_at":"2026-02-15T02:23:17.307777Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.14","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:33.299807Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.14","depends_on_id":"cc-top-eho.7","type":"blocks","created_at":"2026-02-15T01:46:46.739199Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.14","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:47.1402Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.15","title":"Implement PID-to-session correlator using port fingerprinting and timing heuristic","description":"The correlator maps Claude Code PIDs to OTLP session.ids using ephemeral source port tracking as the primary method and a 10-second timing heuristic as fallback.\n\n## Inputs\n- **connection_info** (`ConnectionInfo`): Source IP, source port, session.id from OTLP request -- Source: OTLP receivers\n- **process_list** (`list\u003cProcessInfo\u003e`): PIDs with open socket info -- Source: Process scanner\n\n## Outputs\n- **correlation** (`map\u003cPID, session.id\u003e`): Each PID maps to at most one session.id -- Dest: State store\n\n## Constraints\n- Port fingerprinting is primary; timing heuristic is fallback only\n- Uses proc_pidfdinfo macOS API (//go:build darwin)\n- Must handle race conditions where process exits between scan and correlation\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-pid-session-correlator\",\"files_scope\":[\"internal/correlator/correlator.go\",\"internal/correlator/correlator_test.go\",\"internal/correlator/portmap_darwin.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"connection_info\",\"type\":\"ConnectionInfo\",\"constraints\":\"Source IP, source port, session.id from OTLP request\",\"source\":\"OTLP receivers\"},{\"name\":\"process_list\",\"type\":\"list\\u003cProcessInfo\\u003e\",\"constraints\":\"PIDs with open socket info\",\"source\":\"Process scanner\"}],\"outputs\":[{\"name\":\"correlation\",\"type\":\"map\\u003cPID, session.id\\u003e\",\"constraints\":\"Each PID maps to at most one session.id\",\"destination\":\"State store\"}]}}","acceptance_criteria":"- When PID 4821 has an open socket from ephemeral port 52345 and an OTLP request arrives from port 52345 with session.id='sess-abc', the correlator maps PID 4821 to 'sess-abc'\n- When two PIDs have distinct source ports and sessions, each PID maps to its own session only\n- When port fingerprinting fails and a new PID appears within 10 seconds of a new session.id, the timing heuristic matches them\n- When a PID exits and a new PID starts, the old correlation is preserved as 'Exited' and the new PID gets a new correlation\n- When an OTLP session has no matching PID, it appears as 'PID: ---' in the store\n- Uses proc_pidfdinfo to enumerate open file descriptors for port-to-PID mapping\n- TestCorrelator_PortFingerprint passes\n- TestCorrelator_TimingHeuristic passes\n- TestCorrelator_NoMatch passes\n- TestCorrelator_TwoSessions passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T01:46:33.879319Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:25:20.377416Z","closed_at":"2026-02-15T02:25:20.377416Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.15","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:33.88043Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.15","depends_on_id":"cc-top-eho.7","type":"blocks","created_at":"2026-02-15T01:46:47.545675Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.15","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:47.95634Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.16","title":"Implement graceful shutdown with drain, port release, and terminal restore","description":"Pressing q triggers graceful shutdown: stop accepting new connections, drain in-flight OTLP requests within 5 seconds, release ports, and restore the terminal to its original state.\n\n## Inputs\n- **quit_signal** (`KeyMsg`): q key press or SIGINT/SIGTERM -- Source: TUI keyboard or OS signal\n- **receivers** (`list\u003cReceiver\u003e`): gRPC and HTTP receivers -- Source: OTLP receivers\n- **tui_program** (`tea.Program`): Running Bubble Tea program -- Source: TUI\n\n## Outputs\n- **clean_exit** (`bool`): All resources released -- Dest: Process exit\n\n## Constraints\n- Use context.WithTimeout for 5-second drain\n- Register SIGINT/SIGTERM handlers\n- Bubble Tea's alternate screen cleanup must run even on forced exit\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-graceful-shutdown\",\"files_scope\":[\"internal/tui/shutdown.go\",\"cmd/cc-top/main.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"quit_signal\",\"type\":\"KeyMsg\",\"constraints\":\"q key press or SIGINT/SIGTERM\",\"source\":\"TUI keyboard or OS signal\"},{\"name\":\"receivers\",\"type\":\"list\\u003cReceiver\\u003e\",\"constraints\":\"gRPC and HTTP receivers\",\"source\":\"OTLP receivers\"},{\"name\":\"tui_program\",\"type\":\"tea.Program\",\"constraints\":\"Running Bubble Tea program\",\"source\":\"TUI\"}],\"outputs\":[{\"name\":\"clean_exit\",\"type\":\"bool\",\"constraints\":\"All resources released\",\"destination\":\"Process exit\"}]}}","acceptance_criteria":"- Pressing q stops accepting new OTLP connections immediately\n- In-flight OTLP requests are allowed up to 5 seconds to complete\n- After 5-second drain timeout, remaining connections are forcibly closed\n- Ports 4317 and 4318 (or custom) are released and immediately available for reuse\n- Terminal cursor is visible after exit\n- Terminal input echoing is enabled after exit\n- Alternate screen buffer is cleared after exit\n- Exit completes within 6 seconds (5s drain + 1s cleanup)\n- SIGINT and SIGTERM also trigger graceful shutdown\n- TestE2E_GracefulShutdown passes","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:34.45544Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:39.381536Z","closed_at":"2026-02-15T02:30:39.381536Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.16","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:34.456486Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.16","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:48.362014Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.16","depends_on_id":"cc-top-eho.8","type":"blocks","created_at":"2026-02-15T01:46:48.758162Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.16","depends_on_id":"cc-top-eho.9","type":"blocks","created_at":"2026-02-15T01:46:49.149025Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.17","title":"Implement alert engine with 7 configurable alert rules","description":"The alert engine evaluates 7 rules (Cost Surge, Runaway Tokens, Loop Detector, Error Storm, Stale Session, Context Pressure, High Rejection Rate) against state store data and fires alerts with configurable thresholds.\n\n## Inputs\n- **state** (`StateStore`): Contains metrics and events indexed by session.id -- Source: State store\n- **config** (`AlertConfig`): Thresholds for each rule -- Source: Config parser\n- **model_limits** (`map\u003cstring, int\u003e`): Model name to context token limit -- Source: Config parser\n\n## Outputs\n- **alerts** (`list\u003cAlert\u003e`): Each alert has rule name, severity, message, session.id (if applicable) -- Dest: TUI alerts panel and system notification\n\n## Constraints\n- Evaluation runs on a configurable interval (default 1 second)\n- Each rule is independently configurable and can be disabled\n- osascript notification uses exec.Command, not CGo\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-alert-engine\",\"files_scope\":[\"internal/alerts/engine.go\",\"internal/alerts/engine_test.go\",\"internal/alerts/rules.go\",\"internal/alerts/notify_darwin.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"state\",\"type\":\"StateStore\",\"constraints\":\"Contains metrics and events indexed by session.id\",\"source\":\"State store\"},{\"name\":\"config\",\"type\":\"AlertConfig\",\"constraints\":\"Thresholds for each rule\",\"source\":\"Config parser\"},{\"name\":\"model_limits\",\"type\":\"map\\u003cstring, int\\u003e\",\"constraints\":\"Model name to context token limit\",\"source\":\"Config parser\"}],\"outputs\":[{\"name\":\"alerts\",\"type\":\"list\\u003cAlert\\u003e\",\"constraints\":\"Each alert has rule name, severity, message, session.id (if applicable)\",\"destination\":\"TUI alerts panel and system notification\"}]}}","acceptance_criteria":"- When $/hr exceeds $2.00 (default), a 'Cost Surge' alert fires with the current rate\n- When $/hr is $1.99, no 'Cost Surge' alert fires\n- When token velocity exceeds 50k tokens/min sustained for 3 minutes, 'Runaway Tokens' fires\n- When the same bash command hash fails 3 times in 5 minutes for a session, 'Loop Detector' fires for that session\n- When 3 normalized-equivalent commands fail (npm test/run test/npx jest), 'Loop Detector' fires\n- When \u003e10 api_error events occur in 1 minute, 'Error Storm' fires\n- When a session is active \u003e2 hours with 0 user_prompt events, 'Stale Session' fires\n- When input_tokens \u003e 80% of model context limit, 'Context Pressure' fires\n- When model is not in context limit map, no alert fires and a one-time warning is logged\n- When \u003e50% of tool_decisions are 'reject' in 5 minutes, 'High Rejection Rate' fires\n- Custom thresholds from config override all defaults\n- When system_notify=true, fired alerts trigger osascript display notification\n- When system_notify=false, no osascript is called but alert still appears in results\n- TestAlertCostSurge_Fires passes\n- TestAlertCostSurge_BelowThreshold passes\n- TestAlertRunawayTokens_Fires passes\n- TestAlertLoopDetector_Fires passes\n- TestAlertLoopDetector_Normalization passes\n- TestAlertErrorStorm_Fires passes\n- TestAlertStaleSession_Fires passes\n- TestAlertContextPressure_Fires passes\n- TestAlertContextPressure_UnknownModel passes\n- TestAlertHighRejection_Fires passes\n- TestAlertEngine_WithStateStore passes\n- TestAlertNotification_OSAScript passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T01:46:35.036189Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:27:08.606247Z","closed_at":"2026-02-15T02:27:08.606247Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.17","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:35.037301Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.17","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:49.540117Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.17","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:49.952148Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.17","depends_on_id":"cc-top-eho.5","type":"blocks","created_at":"2026-02-15T01:46:50.363895Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.17","depends_on_id":"cc-top-eho.10","type":"blocks","created_at":"2026-02-15T01:46:50.75983Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.18","title":"Implement burn rate odometer panel with retro-styled digital counter","description":"The burn rate panel displays total cost, $/hour rate, trend arrow, and token velocity as a retro-styled digital counter with color thresholds (green/yellow/red).\n\n## Inputs\n- **burn_rate** (`BurnRate`): From burn rate calculator -- Source: Burn rate calculator\n- **selected_session** (`optional\u003cstring\u003e`): Session filter or nil for global -- Source: TUI state\n\n## Outputs\n- **panel_view** (`string`): Styled text with color-coded counter -- Dest: TUI layout\n\n## Constraints\n- Use Lipgloss for retro-styled digital counter appearance\n- Colors must be configurable via config thresholds\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-burn-rate-odometer\",\"files_scope\":[\"internal/tui/burnrate.go\",\"internal/tui/burnrate_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"burn_rate\",\"type\":\"BurnRate\",\"constraints\":\"From burn rate calculator\",\"source\":\"Burn rate calculator\"},{\"name\":\"selected_session\",\"type\":\"optional\\u003cstring\\u003e\",\"constraints\":\"Session filter or nil for global\",\"source\":\"TUI state\"}],\"outputs\":[{\"name\":\"panel_view\",\"type\":\"string\",\"constraints\":\"Styled text with color-coded counter\",\"destination\":\"TUI layout\"}]}}","acceptance_criteria":"- Total cost displays as dollar amount with 2 decimal places\n- $/hour rate displays with 2 decimal places\n- Up-arrow appears when rate is increasing, down-arrow when decreasing\n- Counter color is green when rate \u003c $0.50/hr (default)\n- Counter color is yellow when rate $0.50-$1.99/hr (default)\n- Counter color is red when rate \u003e= $2.00/hr (default)\n- Token velocity displays as 'X,XXX tokens/min'\n- When a session is selected, shows only that session's data\n- When in global view, shows aggregate data from all sessions","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:35.622349Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:31.350685Z","closed_at":"2026-02-15T02:30:31.350685Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.18","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:35.623452Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.18","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:51.154138Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.18","depends_on_id":"cc-top-eho.10","type":"blocks","created_at":"2026-02-15T01:46:51.55242Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.19","title":"Implement ring buffer for events with configurable capacity and eviction","description":"The event buffer stores up to N events (default 1000) in a ring buffer, evicting the oldest event when full, and supports filtered iteration by session and event type.\n\n## Inputs\n- **event** (`FormattedEvent`): Must have session.id and event type -- Source: Event formatter\n- **capacity** (`int`): capacity \u003e= 1 -- Source: Config (event_buffer_size)\n\n## Outputs\n- **events** (`list\u003cFormattedEvent\u003e`): Ordered newest-first, len \u003c= capacity -- Dest: Event stream panel\n\n## Constraints\n- Thread-safe for concurrent Add and List operations\n- Use ring buffer, not unbounded slice\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-event-buffer\",\"files_scope\":[\"internal/events/buffer.go\",\"internal/events/buffer_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"event\",\"type\":\"FormattedEvent\",\"constraints\":\"Must have session.id and event type\",\"source\":\"Event formatter\"},{\"name\":\"capacity\",\"type\":\"int\",\"constraints\":\"capacity \\u003e= 1\",\"source\":\"Config (event_buffer_size)\"}],\"outputs\":[{\"name\":\"events\",\"type\":\"list\\u003cFormattedEvent\\u003e\",\"constraints\":\"Ordered newest-first, len \\u003c= capacity\",\"destination\":\"Event stream panel\"}]}}","acceptance_criteria":"- Add() on a buffer with capacity 1000 stores events up to 1000\n- When event 1001 is added, the oldest event is evicted and only 1000 remain\n- ListBySession('sess-abc') returns only events for that session\n- ListByType('api_error') returns only api_error events\n- ListAll() returns events in chronological order (newest last)\n- A buffer with capacity=1 holds exactly 1 event after 100 adds\n- TestEventBuffer_Eviction passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:36.201119Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:20:34.470646Z","closed_at":"2026-02-15T02:20:34.470646Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.19","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:36.202226Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.19","depends_on_id":"cc-top-eho.11","type":"blocks","created_at":"2026-02-15T01:46:51.933817Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.2","title":"Implement TOML config parser with defaults and validation","description":"The config package loads ~/.config/cc-top/config.toml, merges with sensible defaults for all settings, and returns validation errors for invalid values.\n\n## Inputs\n- **config_file** (`optional\u003cstring\u003e`): Valid TOML syntax or absent -- Source: ~/.config/cc-top/config.toml\n\n## Outputs\n- **config** (`Config struct`): All fields populated with valid values -- Dest: Return value\n\n## Constraints\n- Use BurntSushi/toml for TOML parsing\n- All config values must have sensible defaults\n- Validate port ranges (1-65535), positive thresholds, positive buffer sizes\n\n## Error Cases\n- **Config file not found**: Use all defaults, no error -\u003e Valid Config with defaults\n- **Invalid TOML syntax**: Return parse error with file path and line number -\u003e Error message\n- **grpc_port = -1**: Return validation error -\u003e 'grpc_port must be between 1 and 65535'\n- **grpc_port = 65536**: Return validation error -\u003e 'grpc_port must be between 1 and 65535'\n- **event_buffer_size = 0**: Return validation error -\u003e 'event_buffer_size must be \u003e= 1'\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-config-parser\",\"files_scope\":[\"internal/config/config.go\",\"internal/config/config_test.go\",\"internal/config/defaults.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"config_file\",\"type\":\"optional\\u003cstring\\u003e\",\"constraints\":\"Valid TOML syntax or absent\",\"source\":\"~/.config/cc-top/config.toml\"}],\"outputs\":[{\"name\":\"config\",\"type\":\"Config struct\",\"constraints\":\"All fields populated with valid values\",\"destination\":\"Return value\"}]}}","acceptance_criteria":"- When no config file exists, Load() returns Config with gRPC port 4317, HTTP port 4318, scan interval 5s, event buffer 1000\n- When config.toml sets grpc_port = 5317, Load() returns Config with gRPC port 5317 and all other fields at defaults\n- When config.toml sets grpc_port = -1, Load() returns a validation error containing 'grpc_port must be between 1 and 65535'\n- When config.toml contains unknown_key = true, Load() returns Config with a warning logged about the unknown key\n- When config.toml sets model context limits under [models], they are available in Config.Models map\n- When config.toml sets alert thresholds, they override defaults in Config.Alerts\n- TestConfigParser_Defaults passes\n- TestConfigParser_CustomPorts passes\n- TestConfigParser_PartialConfig passes\n- TestConfigParser_InvalidValue passes\n- TestConfigParser_UnknownKey passes\n- TestConfigParser_ModelContextLimits passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:26.185517Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:19:04.69033Z","closed_at":"2026-02-15T02:19:04.69033Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.2","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:26.187769Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.2","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:40.081026Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.20","title":"Implement full-screen stats dashboard with Tab toggle","description":"The stats dashboard fills the full screen when toggled via Tab, displaying all 9 aggregate statistics in a formatted layout, and returns to the main dashboard on another Tab press.\n\n## Inputs\n- **stats** (`DashboardStats`): From stats calculator -- Source: Stats calculator\n- **selected_session** (`optional\u003cstring\u003e`): Session filter or nil for global -- Source: TUI state\n\n## Outputs\n- **full_screen_view** (`string`): Full terminal screen with all 9 stats -- Dest: Terminal\n\n## Constraints\n- Use Lipgloss for formatting\n- Must handle terminal resize\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-stats-dashboard\",\"files_scope\":[\"internal/tui/stats.go\",\"internal/tui/stats_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"stats\",\"type\":\"DashboardStats\",\"constraints\":\"From stats calculator\",\"source\":\"Stats calculator\"},{\"name\":\"selected_session\",\"type\":\"optional\\u003cstring\\u003e\",\"constraints\":\"Session filter or nil for global\",\"source\":\"TUI state\"}],\"outputs\":[{\"name\":\"full_screen_view\",\"type\":\"string\",\"constraints\":\"Full terminal screen with all 9 stats\",\"destination\":\"Terminal\"}]}}","acceptance_criteria":"- Tab press from main dashboard shows full-screen stats view\n- Tab press from stats view returns to main dashboard\n- Stats view displays: lines added/removed, commits, PRs, tool acceptance rate by tool, cache efficiency %, average API latency, model breakdown (cost + tokens by model), top tools ranked by frequency, error rate %\n- When a session is selected, stats show only that session's data\n- When in global view, stats aggregate all sessions\n- Handles terminal resize correctly","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:36.781744Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:37.156544Z","closed_at":"2026-02-15T02:30:37.156544Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.20","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:36.790107Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.20","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:52.321245Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.20","depends_on_id":"cc-top-eho.12","type":"blocks","created_at":"2026-02-15T01:46:52.699713Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.21","title":"Implement TUI startup screen with process table and action keys","description":"The startup screen displays a table of all discovered Claude Code processes with telemetry status and provides [E], [F], and [Enter] action keys for configuration and navigation.\n\n## Inputs\n- **processes** (`list\u003cProcessInfo\u003e`): From process scanner with telemetry classification -- Source: Process scanner + telemetry classifier\n- **settings_merge** (`SettingsMerge`): Merge capability for [E] and [F] actions -- Source: Settings merge package\n\n## Outputs\n- **tui_view** (`Bubble Tea Model`): Renders process table with action hints -- Dest: Terminal\n- **navigation** (`ViewTransition`): Enter transitions to main dashboard -- Dest: TUI router\n\n## Constraints\n- Use Bubble Tea framework for TUI\n- Must handle terminal resize\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-startup-screen\",\"files_scope\":[\"internal/tui/startup.go\",\"internal/tui/startup_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"processes\",\"type\":\"list\\u003cProcessInfo\\u003e\",\"constraints\":\"From process scanner with telemetry classification\",\"source\":\"Process scanner + telemetry classifier\"},{\"name\":\"settings_merge\",\"type\":\"SettingsMerge\",\"constraints\":\"Merge capability for [E] and [F] actions\",\"source\":\"Settings merge package\"}],\"outputs\":[{\"name\":\"tui_view\",\"type\":\"Bubble Tea Model\",\"constraints\":\"Renders process table with action hints\",\"destination\":\"Terminal\"},{\"name\":\"navigation\",\"type\":\"ViewTransition\",\"constraints\":\"Enter transitions to main dashboard\",\"destination\":\"TUI router\"}]}}","acceptance_criteria":"- Startup screen shows a table with columns: PID, Terminal, CWD, Telemetry, OTLP Dest, Status\n- A summary line shows 'N connected, N misconfigured, N no telemetry'\n- Pressing [E] merges OTel env vars into settings.json and shows confirmation message\n- Pressing [F] updates only the endpoint in settings.json when 'Wrong port' sessions exist\n- Pressing Enter transitions to the main dashboard\n- When all sessions are correctly configured, [E] and [F] are greyed out\n- When no processes are found, screen shows 'No Claude Code instances found' with hint to start one\n- Pressing [R] triggers a rescan","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:37.373322Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:36.019347Z","closed_at":"2026-02-15T02:30:36.019347Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.21","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:37.37481Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.21","depends_on_id":"cc-top-eho.7","type":"blocks","created_at":"2026-02-15T01:46:53.084447Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.21","depends_on_id":"cc-top-eho.14","type":"blocks","created_at":"2026-02-15T01:46:53.464819Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.21","depends_on_id":"cc-top-eho.4","type":"blocks","created_at":"2026-02-15T01:46:53.848391Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.22","title":"Implement session list panel with navigation and selection","description":"The session list panel displays all sessions with full metadata, supports keyboard navigation and selection, and updates all other panels when a session is selected or deselected.\n\n## Inputs\n- **sessions** (`list\u003cSessionData\u003e`): From state store with correlation and classification data -- Source: State store\n- **selected** (`optional\u003cstring\u003e`): session.id or nil for global view -- Source: TUI state\n\n## Outputs\n- **panel_view** (`string`): Formatted session rows -- Dest: TUI layout\n- **selection_event** (`SessionSelectedMsg`): Emitted on Enter/Esc -- Dest: Other TUI panels\n\n## Constraints\n- Long CWD paths must be truncated with ~ substitution and ellipsis\n- Session ID truncated to 8 characters\n- Active time formatted as HH:MM:SS\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-session-list\",\"files_scope\":[\"internal/tui/sessionlist.go\",\"internal/tui/sessionlist_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"sessions\",\"type\":\"list\\u003cSessionData\\u003e\",\"constraints\":\"From state store with correlation and classification data\",\"source\":\"State store\"},{\"name\":\"selected\",\"type\":\"optional\\u003cstring\\u003e\",\"constraints\":\"session.id or nil for global view\",\"source\":\"TUI state\"}],\"outputs\":[{\"name\":\"panel_view\",\"type\":\"string\",\"constraints\":\"Formatted session rows\",\"destination\":\"TUI layout\"},{\"name\":\"selection_event\",\"type\":\"SessionSelectedMsg\",\"constraints\":\"Emitted on Enter/Esc\",\"destination\":\"Other TUI panels\"}]}}","acceptance_criteria":"- Each session row shows PID, truncated session ID (8 chars), terminal, CWD (with ~ substitution and ellipsis), telemetry icon, model, status, cost, tokens, and active time\n- Status shows 'active' when last event was within 30 seconds\n- Status shows 'idle' when last event was 30s-5min ago\n- Status shows 'done' when last event was \u003e5min ago\n- Status shows 'exited' for processes that have exited, with final stats preserved\n- Non-telemetry sessions appear greyed out at the bottom\n- Arrow keys navigate up/down, Enter selects, Esc returns to global view\n- When a session is selected, all other panels filter to that session\n- When Esc is pressed, panels return to aggregate global view\n- CWD paths \u003e30 chars are truncated with ~ home-dir substitution and ellipsis\n- TestSessionStatus_Active passes\n- TestSessionStatus_Idle passes\n- TestSessionStatus_Done passes\n- TestTUIModel_SessionSelection passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:37.949464Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:32.482019Z","closed_at":"2026-02-15T02:30:32.482019Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.22","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:37.950599Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.22","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:54.237839Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.22","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:54.667534Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.22","depends_on_id":"cc-top-eho.14","type":"blocks","created_at":"2026-02-15T01:46:55.077063Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.23","title":"Implement alerts panel in bottom bar with system notification integration","description":"The alerts panel displays triggered alerts in a bottom bar with severity icons and supports optional macOS system notifications via osascript.\n\n## Inputs\n- **alerts** (`list\u003cAlert\u003e`): From alert engine -- Source: Alert engine\n- **notify_enabled** (`bool`): From config system_notify -- Source: Config\n\n## Outputs\n- **panel_view** (`string`): Bottom bar with alert messages -- Dest: TUI layout\n\n## Constraints\n- osascript calls must be non-blocking (use goroutine)\n- Do not duplicate notifications for the same alert within 60 seconds\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-alerts-panel\",\"files_scope\":[\"internal/tui/alerts.go\",\"internal/tui/alerts_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"alerts\",\"type\":\"list\\u003cAlert\\u003e\",\"constraints\":\"From alert engine\",\"source\":\"Alert engine\"},{\"name\":\"notify_enabled\",\"type\":\"bool\",\"constraints\":\"From config system_notify\",\"source\":\"Config\"}],\"outputs\":[{\"name\":\"panel_view\",\"type\":\"string\",\"constraints\":\"Bottom bar with alert messages\",\"destination\":\"TUI layout\"}]}}","acceptance_criteria":"- When no alerts are active, the bottom bar shows a status line\n- When a 'Cost Surge' alert fires, it appears in the bottom bar with a warning icon and the rate value\n- Multiple alerts display in a scrollable list if they exceed the bar width\n- Alert messages include the rule name, severity, and relevant values\n- When system_notify=true, osascript display notification is called for each new alert\n- When system_notify=false, no osascript calls occur\n- Alerts for a selected session are highlighted","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:38.541728Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:34.854474Z","closed_at":"2026-02-15T02:30:34.854474Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.23","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:38.543042Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.23","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:55.50693Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.23","depends_on_id":"cc-top-eho.17","type":"blocks","created_at":"2026-02-15T01:46:55.914221Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.24","title":"Implement event stream panel with filtering and auto-scroll","description":"The event stream panel displays a real-time scrolling feed of formatted events, supports filtering by session, event type, and success/failure, and auto-scrolls to show newest events.\n\n## Inputs\n- **events** (`list\u003cFormattedEvent\u003e`): From event buffer, pre-formatted -- Source: Event buffer\n- **filters** (`EventFilters`): Optional session, type, and success filters -- Source: TUI state\n\n## Outputs\n- **panel_view** (`string`): Filtered, scrollable event list -- Dest: TUI layout\n\n## Constraints\n- Render at configurable refresh rate (default 500ms) to avoid TUI freezes\n- Buffer events between renders\n- Use Bubble Tea viewport for scrolling\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-event-stream\",\"files_scope\":[\"internal/tui/eventstream.go\",\"internal/tui/eventstream_test.go\",\"internal/tui/filter.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"events\",\"type\":\"list\\u003cFormattedEvent\\u003e\",\"constraints\":\"From event buffer, pre-formatted\",\"source\":\"Event buffer\"},{\"name\":\"filters\",\"type\":\"EventFilters\",\"constraints\":\"Optional session, type, and success filters\",\"source\":\"TUI state\"}],\"outputs\":[{\"name\":\"panel_view\",\"type\":\"string\",\"constraints\":\"Filtered, scrollable event list\",\"destination\":\"TUI layout\"}]}}","acceptance_criteria":"- Events render in chronological order with newest at bottom\n- Panel auto-scrolls to newest event on update\n- Pressing 'f' opens a filter menu with session, event type, and success/failure options\n- Applying a filter immediately updates the visible events\n- When a session is selected in the session list, only that session's events show\n- When no events exist, panel shows 'No data received yet'\n- Panel remains responsive with 200 events/second input (renders at 500ms intervals)\n- Scroll up/down with j/k or arrow keys when panel is focused","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:39.115359Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:33.642623Z","closed_at":"2026-02-15T02:30:33.642623Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.24","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:39.116577Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.24","depends_on_id":"cc-top-eho.6","type":"blocks","created_at":"2026-02-15T01:46:56.297137Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.24","depends_on_id":"cc-top-eho.19","type":"blocks","created_at":"2026-02-15T01:46:56.732482Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.25","title":"Implement kill switch with SIGSTOP/SIGKILL/SIGCONT and confirmation dialog","description":"The kill switch (Ctrl+K) sends SIGSTOP to freeze the selected session's process, shows a confirmation dialog, then sends SIGKILL on confirm or SIGCONT on cancel.\n\n## Inputs\n- **selected_session** (`optional\u003cSessionData\u003e`): Must have a PID, or show picker if no selection -- Source: TUI state\n- **user_confirmation** (`bool`): Y to kill, n/Esc to cancel -- Source: TUI keyboard input\n\n## Outputs\n- **signal_sent** (`Signal`): SIGSTOP, then SIGKILL or SIGCONT -- Dest: Target process group\n- **session_update** (`SessionStatus`): Marked 'Exited' on kill -- Dest: State store\n\n## Constraints\n- Send signals to process group (-PID), not just PID\n- Handle ESRCH (no such process) gracefully\n- Must work on macOS (syscall.Kill)\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-kill-switch\",\"files_scope\":[\"internal/tui/killswitch.go\",\"internal/tui/killswitch_test.go\",\"internal/process/signal.go\",\"internal/process/signal_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"selected_session\",\"type\":\"optional\\u003cSessionData\\u003e\",\"constraints\":\"Must have a PID, or show picker if no selection\",\"source\":\"TUI state\"},{\"name\":\"user_confirmation\",\"type\":\"bool\",\"constraints\":\"Y to kill, n/Esc to cancel\",\"source\":\"TUI keyboard input\"}],\"outputs\":[{\"name\":\"signal_sent\",\"type\":\"Signal\",\"constraints\":\"SIGSTOP, then SIGKILL or SIGCONT\",\"destination\":\"Target process group\"},{\"name\":\"session_update\",\"type\":\"SessionStatus\",\"constraints\":\"Marked 'Exited' on kill\",\"destination\":\"State store\"}]}}","acceptance_criteria":"- Ctrl+K on a selected session sends SIGSTOP to the process group\n- Confirmation dialog shows 'Kill session \u003cid\u003e (PID \u003cpid\u003e, \u003ccwd\u003e)? [Y/n]'\n- Y confirms: SIGKILL sent to process group, session marked 'Exited'\n- n or Esc cancels: SIGCONT sent to process group, dialog closes, session resumes\n- When no session is selected (global view), a session picker appears listing all active sessions\n- When the target process has already exited, the 'no such process' error is handled gracefully and session is marked 'Exited'\n- When an already-exited session is selected and Ctrl+K pressed, 'Session already exited' message displays and no signals are sent\n- TestKillSwitch_SIGSTOPAndKill passes\n- TestKillSwitch_Cancel_SIGCONT passes\n- TestKillSwitch_ExitedProcess passes","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:39.688151Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:38.276171Z","closed_at":"2026-02-15T02:30:38.276171Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.25","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:39.689363Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.25","depends_on_id":"cc-top-eho.22","type":"blocks","created_at":"2026-02-15T01:46:57.171829Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.25","depends_on_id":"cc-top-eho.7","type":"blocks","created_at":"2026-02-15T01:46:57.576586Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.3","title":"Implement in-memory state store indexed by session ID","description":"The state store provides thread-safe storage and retrieval of OTLP metrics and events indexed by session.id, with support for session enumeration and aggregate queries.\n\n## Inputs\n- **metric** (`OTLPMetric`): May or may not have session.id attribute -- Source: OTLP receiver\n- **event** (`OTLPEvent`): May or may not have session.id attribute -- Source: OTLP receiver\n\n## Outputs\n- **session_data** (`map\u003cstring, SessionData\u003e`): Thread-safe read/write -- Dest: In-memory, queried by TUI and alert engine\n\n## Constraints\n- Use sync.RWMutex for thread-safe access\n- No persistence  all state is in-memory only\n- Must handle counter resets (negative deltas) by treating previous value as 0\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-state-store\",\"files_scope\":[\"internal/state/store.go\",\"internal/state/store_test.go\",\"internal/state/session.go\",\"internal/state/types.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"metric\",\"type\":\"OTLPMetric\",\"constraints\":\"May or may not have session.id attribute\",\"source\":\"OTLP receiver\"},{\"name\":\"event\",\"type\":\"OTLPEvent\",\"constraints\":\"May or may not have session.id attribute\",\"source\":\"OTLP receiver\"}],\"outputs\":[{\"name\":\"session_data\",\"type\":\"map\\u003cstring, SessionData\\u003e\",\"constraints\":\"Thread-safe read/write\",\"destination\":\"In-memory, queried by TUI and alert engine\"}]}}","acceptance_criteria":"- AddMetric with session.id='sess-001' stores the metric retrievable via GetSession('sess-001')\n- AddEvent with session.id='sess-002' stores the event retrievable via GetSession('sess-002')\n- AddMetric with missing session.id stores under 'unknown' session bucket\n- AddEvent with missing session.id stores under 'unknown' session bucket and logs a warning\n- ListSessions() returns all session IDs including 'unknown' if populated\n- Concurrent AddMetric calls from multiple goroutines do not cause data races (go test -race passes)\n- GetAggregatedCost() returns the sum of cost.usage across all sessions\n- TestStateStore_IndexMetricBySessionID passes\n- TestStateStore_IndexEventBySessionID passes\n- TestStateStore_MissingSessID passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:26.788321Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:18:18.541335Z","closed_at":"2026-02-15T02:18:18.541335Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.3","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:26.789533Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.3","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:40.465703Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.4","title":"Implement settings.json merge logic for OTel environment variables","description":"The settings package reads ~/.claude/settings.json, merges required OTel environment variables into the 'env' block, preserves all other keys and original indentation, and handles all error conditions.\n\n## Inputs\n- **settings_path** (`string`): Default ~/.claude/settings.json -- Source: Filesystem\n- **interactive** (`bool`): true for TUI, false for --setup CLI -- Source: Caller context\n- **fix_port_only** (`bool`): true when [F] pressed, false for [E] -- Source: Caller context\n\n## Outputs\n- **updated_file** (`JSON file`): Valid JSON preserving original indentation -- Dest: ~/.claude/settings.json\n- **result** (`MergeResult`): Success, AlreadyConfigured, Error, or NeedsConfirmation -- Dest: Return value\n\n## Constraints\n- Use atomic write (write to temp file, then rename) to avoid corruption\n- Detect indentation by examining first indented line of original file\n- Never lose data  backup before any destructive operation\n\n## Error Cases\n- **File does not exist**: Create with OTel env vars -\u003e New file with env block\n- **Malformed JSON**: Create .bak backup, return error -\u003e Error: settings.json contains invalid JSON. Backup saved.\n- **Permission denied**: Return error, no crash -\u003e Error: permission denied writing to ~/.claude/settings.json\n- **Concurrent write by another tool**: Atomic write via temp+rename prevents corruption -\u003e Clean file or error\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-settings-merge\",\"files_scope\":[\"internal/settings/merge.go\",\"internal/settings/merge_test.go\",\"internal/settings/indent.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"settings_path\",\"type\":\"string\",\"constraints\":\"Default ~/.claude/settings.json\",\"source\":\"Filesystem\"},{\"name\":\"interactive\",\"type\":\"bool\",\"constraints\":\"true for TUI, false for --setup CLI\",\"source\":\"Caller context\"},{\"name\":\"fix_port_only\",\"type\":\"bool\",\"constraints\":\"true when [F] pressed, false for [E]\",\"source\":\"Caller context\"}],\"outputs\":[{\"name\":\"updated_file\",\"type\":\"JSON file\",\"constraints\":\"Valid JSON preserving original indentation\",\"destination\":\"~/.claude/settings.json\"},{\"name\":\"result\",\"type\":\"MergeResult\",\"constraints\":\"Success, AlreadyConfigured, Error, or NeedsConfirmation\",\"destination\":\"Return value\"}]}}","acceptance_criteria":"- Given {\"env\": {\"MY_VAR\": \"keep\"}, \"other_key\": true}, Merge adds OTel keys to env block and MY_VAR is still 'keep' and other_key is still true\n- When settings.json does not exist, Merge creates it with the required OTel env vars\n- When all OTel keys are already correct, Merge returns AlreadyConfigured and does not write the file\n- When settings.json contains invalid JSON, Merge creates a .bak backup and returns an error without writing\n- When settings.json is read-only, Merge returns an error containing 'permission denied'\n- When settings.json uses 4-space indentation, the output preserves 4-space indentation\n- When fix_port_only=true, only OTEL_EXPORTER_OTLP_ENDPOINT is updated\n- When interactive=false and an existing value differs, Merge warns but does not overwrite\n- TestSettingsMerge_AddKeys passes\n- TestSettingsMerge_CreateFile passes\n- TestSettingsMerge_PreserveIndent passes\n- TestSettingsMerge_AlreadyConfigured passes\n- TestSettingsMerge_MalformedJSON passes\n- TestSettingsMerge_PermissionDenied passes\n- TestSettingsMerge_DifferentValue_NonInteractive passes\n- TestSettingsMerge_FixWrongPort passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:27.392073Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:21:52.166064Z","closed_at":"2026-02-15T02:21:52.166064Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.4","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:27.39334Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.4","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:40.845284Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.5","title":"Implement command normalizer for semantically similar bash commands","description":"The command normalizer groups semantically similar bash commands (e.g., npm test, npm run test, npx jest) into the same group by prefix matching, returning a stable hash for each group.\n\n## Inputs\n- **command** (`string`): Raw bash command from tool_result event -- Source: OTLP event attributes\n\n## Outputs\n- **normalized_hash** (`string`): Stable hash for the command group -- Dest: Alert engine loop detector\n\n## Constraints\n- Use prefix matching for grouping, not exact string comparison\n- Known test-runner families: npm/npx/yarn test variants, pytest variants, go test variants\n- Unknown commands get their own hash (no false grouping)\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-command-normalizer\",\"files_scope\":[\"internal/alerts/normalizer.go\",\"internal/alerts/normalizer_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"command\",\"type\":\"string\",\"constraints\":\"Raw bash command from tool_result event\",\"source\":\"OTLP event attributes\"}],\"outputs\":[{\"name\":\"normalized_hash\",\"type\":\"string\",\"constraints\":\"Stable hash for the command group\",\"destination\":\"Alert engine loop detector\"}]}}","acceptance_criteria":"- Normalize('npm test') and Normalize('npm run test') and Normalize('npx jest') return the same hash\n- Normalize('python -m pytest') and Normalize('pytest') return the same hash\n- Normalize('go test ./...') and Normalize('go test ./pkg/...') return the same hash\n- Normalize('ls -la') returns a unique hash (not grouped with test commands)\n- Normalize('') returns empty string (no hash for empty commands)\n- A 10KB command string is hashed without error\n- TestCommandNormalizer_PrefixMatch passes","status":"closed","priority":2,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":60,"created_at":"2026-02-15T01:46:27.987728Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:17:53.408129Z","closed_at":"2026-02-15T02:17:53.408129Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.5","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:27.989346Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.5","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:41.236703Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.6","title":"Implement main dashboard TUI layout with panel arrangement","description":"The main dashboard arranges the session list, burn rate odometer, event stream, and alerts panels in a responsive layout that handles terminal resize.\n\n## Inputs\n- **terminal_size** (`tuple(int, int)`): Width \u003e= 80, Height \u003e= 24 -- Source: Bubble Tea WindowSizeMsg\n- **active_view** (`ViewState`): Dashboard or Stats -- Source: TUI state\n\n## Outputs\n- **layout** (`Bubble Tea Model`): All panels visible and correctly sized -- Dest: Terminal\n\n## Constraints\n- Use Bubble Tea for TUI framework\n- Use Lipgloss for styling\n- Use Bubbles for reusable components\n- Must re-layout on terminal resize without data loss\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-tui-main-layout\",\"files_scope\":[\"internal/tui/layout.go\",\"internal/tui/layout_test.go\",\"internal/tui/model.go\",\"internal/tui/keys.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"terminal_size\",\"type\":\"tuple(int, int)\",\"constraints\":\"Width \\u003e= 80, Height \\u003e= 24\",\"source\":\"Bubble Tea WindowSizeMsg\"},{\"name\":\"active_view\",\"type\":\"ViewState\",\"constraints\":\"Dashboard or Stats\",\"source\":\"TUI state\"}],\"outputs\":[{\"name\":\"layout\",\"type\":\"Bubble Tea Model\",\"constraints\":\"All panels visible and correctly sized\",\"destination\":\"Terminal\"}]}}","acceptance_criteria":"- At 120x40, all four panels (session list, burn rate, event stream, alerts) are visible\n- At 80x24, panels resize to fit without data loss\n- Tab key toggles between main dashboard and stats dashboard full-screen view\n- q key triggers graceful shutdown\n- All keyboard shortcuts (arrows, Enter, Esc, f, Tab, Ctrl+K) are routed to correct handlers\n- TestTUIModel_TabToggle passes","status":"closed","priority":1,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:28.621591Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:30:30.188159Z","closed_at":"2026-02-15T02:30:30.188159Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.6","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:28.622828Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.6","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:41.639175Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.7","title":"Implement macOS process scanner for Claude Code detection","description":"The process scanner uses macOS libproc APIs to discover all running Claude Code processes, returning PID, binary name, command-line arguments, CWD, terminal type, and environment variables for each.\n\n## Inputs\n- **scan_interval** (`duration`): Default 5 seconds, configurable -- Source: Config\n\n## Outputs\n- **processes** (`list\u003cProcessInfo\u003e`): Only processes owned by current user -- Dest: State store and correlator\n\n## Constraints\n- Use macOS libproc APIs: proc_listallpids, proc_pidinfo, sysctl KERN_PROCARGS2\n- No root/sudo required  only scan current user's processes\n- Must use //go:build darwin build tag\n- Must not crash on zombie or permission-denied processes\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-process-scanner\",\"files_scope\":[\"internal/scanner/scanner.go\",\"internal/scanner/scanner_test.go\",\"internal/scanner/libproc_darwin.go\",\"internal/scanner/types.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"scan_interval\",\"type\":\"duration\",\"constraints\":\"Default 5 seconds, configurable\",\"source\":\"Config\"}],\"outputs\":[{\"name\":\"processes\",\"type\":\"list\\u003cProcessInfo\\u003e\",\"constraints\":\"Only processes owned by current user\",\"destination\":\"State store and correlator\"}]}}","acceptance_criteria":"- Scan() returns a ProcessInfo for each running process named 'claude' owned by the current user\n- Scan() detects a 'node' process with '@anthropic-ai/claude-code' in its argv as a Claude Code instance\n- A process named 'claude-helper' is NOT detected (no false positives)\n- Each ProcessInfo includes PID, binary name, CWD, terminal type, and raw environment string\n- Zombie processes with unreadable env vars return a ProcessInfo with EnvReadable=false and no crash\n- StartPeriodicScan() calls Scan() every scan_interval and publishes updates\n- When a new PID appears, it is tagged as 'New' for one scan cycle\n- When a previously seen PID disappears, it is tagged as 'Exited' with preserved last-known data\n- Uses //go:build darwin build tag for macOS-specific code\n- TestProcessScanner_DetectClaude passes\n- TestProcessScanner_DetectNodeClaude passes\n- TestProcessScanner_NewProcess passes\n- TestProcessScanner_ExitedProcess passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T01:46:29.205454Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:22:07.459211Z","closed_at":"2026-02-15T02:22:07.459211Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.7","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:29.206569Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.7","depends_on_id":"cc-top-eho.1","type":"blocks","created_at":"2026-02-15T01:46:42.034928Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.7","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:42.428391Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.8","title":"Implement OTLP gRPC receiver for metrics ingestion","description":"The gRPC receiver listens on the configured port, accepts ExportMetricsServiceRequest payloads, extracts session.id, and stores metrics in the state store.\n\n## Inputs\n- **otlp_request** (`ExportMetricsServiceRequest (protobuf)`): Valid OTLP v1 protobuf -- Source: gRPC connection on configured port\n- **config** (`Config`): Valid gRPC port -- Source: Config parser\n\n## Outputs\n- **stored_metrics** (`Metrics in state store`): Indexed by session.id -- Dest: State store\n- **grpc_response** (`ExportMetricsServiceResponse`): Standard OTLP response -- Dest: gRPC client\n\n## Constraints\n- Use go.opentelemetry.io/collector/receiver/otlpreceiver or hand-rolled gRPC server with OTLP proto\n- Capture inbound connection source port for PID-to-session correlation\n- Must not crash on malformed input\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-otlp-grpc-receiver\",\"files_scope\":[\"internal/receiver/grpc.go\",\"internal/receiver/grpc_test.go\",\"internal/receiver/server.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"otlp_request\",\"type\":\"ExportMetricsServiceRequest (protobuf)\",\"constraints\":\"Valid OTLP v1 protobuf\",\"source\":\"gRPC connection on configured port\"},{\"name\":\"config\",\"type\":\"Config\",\"constraints\":\"Valid gRPC port\",\"source\":\"Config parser\"}],\"outputs\":[{\"name\":\"stored_metrics\",\"type\":\"Metrics in state store\",\"constraints\":\"Indexed by session.id\",\"destination\":\"State store\"},{\"name\":\"grpc_response\",\"type\":\"ExportMetricsServiceResponse\",\"constraints\":\"Standard OTLP response\",\"destination\":\"gRPC client\"}]}}","acceptance_criteria":"- Receiver binds to configured gRPC port (default 4317) on startup\n- A valid ExportMetricsServiceRequest with session.id='sess-001' and cost.usage metric is stored in the state store under 'sess-001'\n- A malformed protobuf payload returns an OTLP error response and receiver continues accepting new requests\n- When the configured port is already in use, Start() returns an error containing 'port 4317 already in use'\n- The source port of the inbound connection is captured and made available for PID correlation\n- TestOTLPReceiver_GRPCMetrics passes\n- TestOTLPReceiver_MalformedPayload passes\n- TestOTLPReceiver_PortConflict passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":480,"created_at":"2026-02-15T01:46:29.784971Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:26:58.966806Z","closed_at":"2026-02-15T02:26:58.966806Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.8","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:29.786311Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.8","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:42.814987Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.8","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:43.200043Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-eho.9","title":"Implement OTLP HTTP receiver for log event ingestion","description":"The HTTP receiver listens on the configured port, accepts OTLP log export requests via HTTP POST, extracts session.id, and stores events in the state store.\n\n## Inputs\n- **otlp_request** (`ExportLogsServiceRequest (protobuf or JSON)`): Valid OTLP v1 payload -- Source: HTTP POST on configured port\n- **config** (`Config`): Valid HTTP port -- Source: Config parser\n\n## Outputs\n- **stored_events** (`Events in state store`): Indexed by session.id -- Dest: State store\n- **http_response** (`HTTP response`): 200 OK or appropriate error code -- Dest: HTTP client\n\n## Constraints\n- Support both protobuf and JSON OTLP encoding\n- Capture inbound connection source port for PID-to-session correlation\n","design":"{\"_template\":{\"version\":\"0.2.0\",\"task_id\":\"implement-otlp-http-receiver\",\"files_scope\":[\"internal/receiver/http.go\",\"internal/receiver/http_test.go\"],\"effects\":\"\",\"inputs\":[{\"name\":\"otlp_request\",\"type\":\"ExportLogsServiceRequest (protobuf or JSON)\",\"constraints\":\"Valid OTLP v1 payload\",\"source\":\"HTTP POST on configured port\"},{\"name\":\"config\",\"type\":\"Config\",\"constraints\":\"Valid HTTP port\",\"source\":\"Config parser\"}],\"outputs\":[{\"name\":\"stored_events\",\"type\":\"Events in state store\",\"constraints\":\"Indexed by session.id\",\"destination\":\"State store\"},{\"name\":\"http_response\",\"type\":\"HTTP response\",\"constraints\":\"200 OK or appropriate error code\",\"destination\":\"HTTP client\"}]}}","acceptance_criteria":"- Receiver binds to configured HTTP port (default 4318) on startup\n- A valid OTLP log export POST with session.id='sess-002' stores the event under 'sess-002' in the state store\n- An invalid payload returns HTTP 400 with OTLP error body and receiver continues\n- When the configured port is already in use, Start() returns an error containing the port number\n- TestOTLPReceiver_HTTPEvents passes","status":"closed","priority":0,"issue_type":"task","owner":"riabtchuk@gmail.com","estimated_minutes":240,"created_at":"2026-02-15T01:46:30.352351Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T02:27:01.936182Z","closed_at":"2026-02-15T02:27:01.936182Z","close_reason":"Closed","labels":["taskval-managed"],"dependencies":[{"issue_id":"cc-top-eho.9","depends_on_id":"cc-top-eho","type":"parent-child","created_at":"2026-02-15T01:46:30.353864Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.9","depends_on_id":"cc-top-eho.3","type":"blocks","created_at":"2026-02-15T01:46:43.588239Z","created_by":"Igor Ryabchuk"},{"issue_id":"cc-top-eho.9","depends_on_id":"cc-top-eho.2","type":"blocks","created_at":"2026-02-15T01:46:43.991768Z","created_by":"Igor Ryabchuk"}]}
{"id":"cc-top-pyh","title":"Add sustained duration check to runaway tokens rule","description":"alerts/rules.go runawayTokensRule fires immediately when token velocity exceeds threshold. Spec requires velocity to be sustained above threshold for \u003e N minutes before firing. Currently no duration tracking exists and no RunawayTokenSustainedMinutes config field. Fix: add state tracking for how long velocity has been elevated, add config field for sustained duration (suggest default 2 min), only fire after sustained period.","status":"closed","priority":2,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:54.585169Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.979152Z","closed_at":"2026-02-15T04:43:25.979152Z","close_reason":"Fixed by parallel agent team"}
{"id":"cc-top-yqx","title":"Fix double cost counting in state store","description":"state/store.go accumulates cost from BOTH cost.usage metrics (via AddMetric delta at line ~154) AND api_request event cost_usd attribute (via AddEvent at lines 193-198). If both metrics and events arrive for the same session, costs are doubled. Fix: choose one authoritative source. The spec lists cost.usage metric as the source for burn rate. Remove the cost accumulation from AddEvent, or deduplicate.","status":"closed","priority":1,"issue_type":"bug","owner":"riabtchuk@gmail.com","created_at":"2026-02-15T04:21:46.710823Z","created_by":"Igor Ryabchuk","updated_at":"2026-02-15T04:43:25.967883Z","closed_at":"2026-02-15T04:43:25.967883Z","close_reason":"Fixed by parallel agent team"}
